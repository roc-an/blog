# MySQL 数据库边学边练光速入门

## （一）MySQL 数据库的一二事

### 数据库是什么？

简单说，**数据库就是存储和管理数据的仓库**。用户可以对其中的数据进行增、删、改、查。

数据可以存在内存中呀，为什么需要数据库？

* 一旦电脑死机、断电或者程序意外退出，内存中的数据还没来及保存，不就没了吗

那数据也可以存在文本文件中呀，为什么需要数据库？

* 文件的读和写是相对较慢的
* 数据量变大后，数据与数据之间的关系变得难以维护
* 访问数据的用户变多后，这么多人对同一个文件进行读/写数据又怎么确保不出问题？
* 硬盘坏了数据丢了怎么办？需要高效的方式来数据备份

所以，需要数据库这类更加专业的工具来存储和管理宝贵的数据。

数据库是企业非常珍贵的财产，一不小心删了库，那只能想办法跑路了~

### MySQL 是关系型数据库

MySQL 目前属于 Oracle（甲骨文）公司，它是一种关系型数据库，使用二维表（比如 Excel 表格）的结构，来存储实体信息，以及实体与实体之间的联系。

比如一张记录了王者荣耀英雄的表，可以是这样的：

| id | name | age | sex | desc |
| -- | -- | -- | -- | -- |
| 1 | "曜" | 18 | "男" | "剑指的方向，就是天才的故乡。" |
| 2 | "孙尚香" | 17 | "女" | "来一发吗，满足你。" |
| 3 | "夏侯惇" | 28 | "男" | "独眼，是男人的浪漫。" |

至于非关系型数据库（NoSQL），比如 MongoDB，很适合用来处理用户操作日志、地理位置信息、社交记录等这类数据量庞大、却又没有复杂关系的数据

在 Web 应用中，最广泛使用的就是 MySQL，它的优势：

* 开源、免费：能力强的公司甚至可以在 MySQL 基础上做二次开发，增强性能
* 功能强大，功能足以应对绝大多数的使用场景，支持千万级别的并发访问

### 基本术语

一个「数据库」是由多张「数据表」（简称“表”）组成的，一张表中又分了「行」和「列」，一行数据就视作一条「记录」。

* 数据库（DataBase）：存储和管理数据的仓库；
* 表（Table）：数据库中的数据集合都放在表（二维表）内；
* 行（Row）和列（Column）：数据表由数据行和数据列构成；
* 记录（Record）：一个数据行就是一个条记录；
* 字段（Field）：记录内的每个列，就是一个字段；

Q：SQL 又是什么？SQL 和 MySQL 有什么关系？
A：SQL 是一门语言，用这门语言可以访问和处理数据库。所以 SQL 和 MySQL 的关系就是——可以用 SQL 语句处理 MySQL 中的数据。

后文会讲解 SQL 语句的基本使用。

### 下载和安装

#### MySQL 安装

这里是 MySQL 的 [官网](https://www.mysql.com)，可以通过官网的 [下载页](https://dev.mysql.com/downloads/mysql/) 根据自己电脑的系统选择下载安装。

#### PhpStudy 安装（可选）

通过 [PhpStudy](https://www.xp.cn) 来安装 MySQL 也是可以的，全中文，对新手非常友好。除了 MySQL 数据库，还提供了 Apache 服务器、FTP、Nginx 代理等模块，傻瓜式配置，上手非常轻松。
#### 数据库可视化操作工具安装

平时浏览数据库中的数据不可能每次都输入一堆 SQL 语句，既花时间又容易出错，这时候一款可视化工具就尤为重要了，它可以大大提高咱们平时学习、使用数据库的效率。

推荐2款市面上常用的数据库可视化工具：

1. Navicat：[http://www.navicat.com.cn](http://www.navicat.com.cn)，支持 MySQL、MongoDB、Oracle 等多达7种数据库。价格比较贵，有能力的朋友还是推荐支持下正版。对于没有收入来源的学生党，白嫖版网上也是有的；
2. MySQL Workbench：[MySQL Workbench](https://www.mysql.com/cn/products/workbench/)，MySQL 官方提供的，免费，同样支持 Windows/Mac OS X/Linux 等各平台。功能同 Navicat 类似，提供数据建模、SQL 开发、服务器配置、用户管理、备份等工具，对数据库进行可视化操作。

这些软件按照提示下载安装即可，遇到安装问题可以在网上搜搜，相关教程有很多，不再赘述。

## （二）使用 Navicat 对数据库进行基本操作

这里以 Navicat 为例做演示，可视化工具之间功能和操作都类似，一通百通。

### 创建连接

数据库下载安装后，设置初始的用户名密码。

然后打开 Navicat，找到「连接」，点击选择 MySQL，先创建与数据库的连接：

输入连接名，这里叫 `hello-mysql`，输入数据库的密码，保存。
### 创建数据库

双击连接可以打开连接，里面初始已经有一些数据库了，不用管它们。

在连接上点右键 -> 新建数据库。

给数据库起名字，这里叫 `test`，字符集选 utf-8，排序规则选第一个，保存。

### 创建表

在界面上双击数据库可以「打开数据库」，在「表」上右键 -> 新建表。

之后就可以在右侧的表操作界面，为表「添加字段」，如图：

其中：

* `id`：`int` 类型，整数;
  * 长度就用默认的 0 就好（MySQL 还是会采用 11 位，这里对于 `int` 类型指的是显示宽度）;
  * 设为主键（整个表每条记录的主键值是唯一的，不允许重复）；
  * 选中，勾选下方的「自动递增」；
* `name`：姓名。`varchar` 类型，字符串，长度设成 10；
* `age`：年龄。`int` 类型，整数；
* `sex`：性别。`varchar` 类型，字符串，长度设成 1；
* `desc`：描述。`text` 类型，长文本，长度默认 255；
* `ctime`：创建时间。`timestamp` 类型，时间戳，设置默认值为 `CURRENT_TIMESTAMP`，即当前时间的时间戳；

添加字段后点击「保存」，或者直接 CTRL + S，输入表名 `user`，创建表成功。

### 添加记录

在表界面右键 -> 添加记录。

按照之前设定的字段类型，输入各字段数据：

其中 `id` 和 `ctime` 不用手动输入，因为咱们设了 `id` 值自增，`ctime` 默认值是当前时间的时间戳。

### 删除表

想删除一个表非常简单，在表上右键 -> 删除表。

先放心大胆地删，后面会学习用 SQL 来创建表。

## （三）常用数据类型

MySQL 支持多种数据类型，主要分为 3 类：

* 数值
* 字符串
* 时间日期

较常用的数据类型举例：

* `varchar(50)`：字符串
* `int`：整数
* `timestamp`：时间戳
* `text`：长文本

完整的数据类型，可以参考 [MySQL Data Types](https://dev.mysql.com/doc/refman/8.0/en/data-types.html)

下面对数值、字符串、时间日期这3种数据类型进行展开，这块内容简单了解即可

### 数值类型

* TINYINT：小整数值，1 byte
* SMALLINT：大整数值，2 bytes
* MEDIUMINT：大整数值，3 bytes
* INT 或 INTEGER：大整数值，4 bytes
* BIGINT：极大整数值，8 bytes

* FLOAT：单精度浮点值，4 bytes
* DOUBLE：双精度浮点值，8 bytes
* DECIMAL：小数值。大小计算，对 DECIMAL(M, D) ，如果 M > D，为 M + 2 否则为 D + 2

### 字符串类型

* CHAR：定长字符串
* VARCHAR：变长字符串

* TINYBLOB：不超过 255 个字符的二进制字符串
* BLOB：二进制形式的长文本数据
* MEDIUMBLOB：二进制形式的中等长度文本数据
* LONGBLOB：二进制形式的极大文本数据

* TINYTEXT：短文本字符串
* TEXT：长文本数据
* MEDIUMTEXT：中等长度文本数据
* LONGTEXT：极大文本数据

### 时间日期类型

* DATE：日期值，格式 YYYY-MM-DD，3 bytes
* TIME：时间值或持续时间，格式 HH:MM:SS，3 bytes
* YEAR：年份值，格式 YYYY，1 bytes
* DATETIME：混合日期和时间值，格式 YYYY-MM-DD HH:MM:SS，8 bytes
* TIMESTAMP：时间戳，混合日期和时间值，格式 YYYYMMDD HHMMSS，4 bytes

可以发现不同的数据类型所占用的字节大小是不同的，因此在实际业务中，合理定义数据字段的类型对于数据库的优化是十分重要的。

## （四）MySQL 基础指令

### 使用 Navicat 执行 SQL 语句

在 Navicat 上方点击「新建查询」，然后输入 SQL 语句后点击「运行」按钮就可以执行 SQL 语句。

下图是创建 `user` 表的 SQL 语句：

执行后，也可以 CTRL + S 将这段 SQL 语句保存，留作后续简单修改后再次执行。

### 创建表

语法：

``` sql
CREATE TABLE 表名(
  字段1 类型 [可选修饰符],
  字段2 类型 [可选修饰符]
  ...
);
```

SQL 示例，创建一个 `user` 表：

``` sql
CREATE TABLE `user`(
  `id` INT PRIMARY KEY AUTO_INCREMENT,
  `name` VARCHAR(10),
  `age` INT,
  `sex` VARCHAR(1),
  `desc` TEXT,
	`ctime` TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

其中：

* 将字段 `id` 设为主键（`PRIMARY KEY`），主键值不允许重复，另外也设成了自增的（`AUTO_INCREMENT`），这样新增一条记录后，该记录的 `id` 就会自动加1；
* 对字段 `ctime` 使用了 `DEFAULT` 约束来设置「默认值」，在创建新记录时把这个字段设置为当前时间的时间戳（`CURRENT_TIMESTAMP`）。

为什么 SQL 语句中的字段要加反斜杠（`）呢？

因为示例中比如 `desc` 这个字段名和 SQL 关键字 `desc` 冲突了，表示降序排列，所以加了反斜杠（`）用以表示字段名叫 desc。

### 向表中新增一条记录

使用 `INSERT INTO` 这个 SQL 语句来新增记录。

语法：

``` sql
INSERT INTO 表名
  (字段1, 字段2, ...)
  VALUES
  (值1, 值2, ...);
```

其中，`字段1`和`值1`对应，`字段2`与`值2`对应，以此类推，支持插入多个字段和对应值。

SQL 示例：

``` sql
INSERT INTO `user`
  (`name`, `age`, `sex`, `desc`)
  VALUES
  ("花木兰", 19, "女", "谁说女子不如男。");
```
新增成功后，可以看 SQL 运行结果：`Affected rows: 1, Time: 0.001000s`，看到结果显示影响了1行数据，说明新增记录成功。

接着，可以修改 SQL，多新增几条记录，如图：

### 修改记录

用 `UPDATE` 语句对表中的数据进行更新。

语法：

``` sql
UPDATE 表名 SET 字段1=值1, 字段2=值2 [可选的 WHERRE 语句]
```

其中：

* 可以同时更新一个或多个字段；
* 可以在 `WHERE` 子句中指定条件，如果不加 `WHERE` 则更新所有记录。

要更新数据表中指定行的数据时 `WHERE` 子句是非常有用的。

SQL 示例：

``` sql
UPDATE user SET `age`=34, `desc`="真相只有一个。" WHERE `id`=8;
```
